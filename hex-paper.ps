%!

%% Name:    hex-paper.ps
%% Purpose: Hexagon-drawing routines.
%%
%% Copyright (C) 1996 Michael J. Fromberger. All Rights Reserved.
%%
%% PostScript source code for drawing collections of arbitrary-sized hexagons,
%% clusters of hexes, and lines of hexes.

% Common definitions
/in { 72 mul } def
/cm { 28.34 mul } def
/pagewidth 8.5 in def
/pageheight 11 in def

% The size of a hex is taken to be the radius from the center of the
% hex to each of the vertices of the hex.
%
% Modify this to change the size of the hexes on the page
%
/hexsize 0.5 cm def

% This determines the weight of the lines drawn.  For best results,
% this should be light (<= 0.5 pt).
/hexlinewidth .3 def

% This determines the gray value of the lines drawn (0 = black).
/hexgray .5 def

%%
%% <r> hex --
%% Draw a hexagon centered at the current point, whose radius is <r> 
%% points.
%%
%% Leaves the current point where it started.
%%
/hex {
  currentpoint 3 2 roll
  dup 0 exch rmoveto
  -60 rotate
  1 1 6 {
    pop
    dup neg 0 exch rlineto
    60 rotate
  } for
  60 rotate
  pop
  moveto
} def

%%
%% <f> <r> hexmoveto --
%% Assuming the current point as the origin, move to the center of a
%% radius <r> hex that would border on the current center's hex, where
%% <f> is defined as:
%%
%%         6 /\ 1
%%          /  \
%%        5 |  | 2
%%          \  /
%%         4 \/ 3
%%
/hexmoveto {
  exch 1 sub
  dup 60 mul neg rotate
  exch dup 0 exch rmoveto
  -60 rotate
  dup 0 exch rmoveto
  60 rotate
  exch 60 mul rotate pop
} def

%%
%% <r> hexblock --
%% Make a block of seven hexes (six surrounding one) centered at the
%% current point, where each hex has radius <r>.
%%
/hexblock {
  dup 5 exch hexmoveto
  1 1 6 {
    1 index dup hex hexmoveto
  } for
  pop
} def

%%
%% <n> <r> hexrow --
%% Make a row of <n> radius <r> hexes (horizontal) based at the current
%% point.  Leaves the current point just past the last hex constructed.
%%
/hexrow {
  1 1 4 3 roll {
    pop dup hex dup 2 exch hexmoveto
  } for
  pop
} def

%%
%% <d> <n> <r> hexline --
%% Make a line of <n> radius-<r> hexes in direction <d> (where <d> is
%% the face of the hex representing the direction to walk in)
%%
/hexline {
  1 1 4 3 roll {
    pop dup hex dup 2 index exch hexmoveto
  } for
  pop pop
} def

%%
%% <k> <n> <r> hexrows -- 
%% Make <k> rows of <n> radius-<r> hexes (horizontal) based at the
%% current point and with rows stacking upward.
%%
/hexrows {
  1 4 1 roll
  1 1 5 4 roll {
    pop currentpoint
    4 2 roll 2 copy hexrow
    4 2 roll moveto
    dup 3 index exch hexmoveto
    3 2 roll 5 add 10 mod 3 1 roll
  } for
  pop pop pop
} def

%%
%% <r> hexpage --
%% Render an 8.5" x 11" page of radius-<r> hexes
%%
/hexpage {
  dup pageheight exch 30 cos mul div ceiling exch
  dup pagewidth exch 30 cos mul div ceiling
  exch
  hexrows
} def

%% -- Draw a page of hexes (uses the above code)
newpath
0 in 0 in moveto
hexsize hexpage
hexlinewidth setlinewidth
hexgray setgray
stroke
showpage

% Here there be dragons
